from fpdf import FPDF
import arabic_reshaper
from bidi.algorithm import get_display

class PDF(FPDF):
    def header(self):
        self.set_font('DejaVu', 'B', 14)
        self.cell(0, 10, get_display(arabic_reshaper.reshape('شركة القلب النابض')), 0, 1, 'C')

    def footer(self):
        self.set_y(-15)
        self.set_font('DejaVu', 'I', 8)
        self.cell(0, 10, get_display(arabic_reshaper.reshape('صفحة ' + str(self.page_no()))), 0, 0, 'C')

    def chapter_title(self, title):
        self.set_font('DejaVu', 'B', 12)
        self.cell(0, 10, get_display(arabic_reshaper.reshape(title)), 0, 1, 'R')
        self.ln(5)

    def chapter_body(self, body):
        self.set_font('DejaVu', '', 12)
        for line in body.split('\n'):
            reshaped_line = arabic_reshaper.reshape(line)
            bidi_line = get_display(reshaped_line)
            self.multi_cell(0, 10, bidi_line, align='R')
            self.ln()

    def add_chapter(self, title, body):
        self.add_page()
        self.chapter_title(title)
        self.chapter_body(body)

# Create instance of FPDF class
pdf = PDF()

# Add a DejaVu font that supports Arabic
pdf.add_font('DejaVu', '', 'C:\\Windows\\Fonts\\Arial.ttf', uni=True)
pdf.add_font('DejaVu', 'B', 'C:\\Windows\\Fonts\\Arial.ttf', uni=True)
pdf.add_font('DejaVu', 'I', 'C:\\Windows\\Fonts\\Arial.ttf', uni=True)

# Adding chapters with the translated content
pdf.add_chapter('رؤيتنا', """1. أن نكون المزود الرائد للحلول المبتكرة لتكنولوجيا المعلومات الصحية، مما يعزز رعاية المرضى والكفاءة التشغيلية في العراق وخارجه.
2. قيادة التحول الرقمي في الرعاية الصحية، وجعل التقنيات الطبية المتقدمة متاحة لجميع مقدمي الرعاية الصحية.
3. تعزيز ثقافة التحسين المستمر والابتكار، وتحديد معايير جديدة في صناعة تكنولوجيا المعلومات الصحية.""")

pdf.add_chapter('مهمتنا', """1. تقديم خدمات تكنولوجيا المعلومات الصحية الحديثة التي تسرع من نمو المعرفة الطبية وتحسن نتائج الرعاية الصحية.
2. التعاون مع المهنيين الصحيين، مستفيدين من خبرتنا في تكنولوجيا المعلومات لتطوير شبكات وحلول برمجية متقدمة.
3. دعم المؤسسات الصحية في العراق والمنطقة بنظم تكنولوجيا المعلومات الشاملة والمتكاملة، مما يضمن تقديم خدمات أفضل ورعاية مرضى محسنة.""")

pdf.add_chapter('المنتجات والخدمات', """حلول تكنولوجيا المعلومات الصحية
- المستشفى الذكي (Smart HIS)
- السجل الطبي الإلكتروني (Smart EMR)
- نظام معلومات المختبرات (Smart LIS)
- نظام أرشفة وتواصل الصور (Smart PACS)
- نظام معلومات الأشعة (Smart RIS)
- نظام إدارة المستودعات (Smart WMS)
- نظام إدارة الصيدلية (Smart Pharma)
- نظام إدارة الموارد البشرية (Smart HR)
- التكامل والاتصال بالأجهزة الطبية (Smart Integration)
- وحدات الإدارة (Smart Management)
- مشاريع مراكز البيانات وحلول الشبكات
- خدمات رعاية العملاء وخدمات ما بعد البيع
- التصميم والتصنيع والإنشاء""")

pdf.add_chapter('الشركاء والعملاء', """القطاع الحكومي
1. وزارة الصحة (MOH)
    - مجلس السرطان
        - سجل السرطان
2. مديرية الرعاية الصحية بمدينة الطب بغداد
    - مستشفى بغداد التعليمي:
        - مركز البيانات الرئيسي بالمستشفى.
        - وحدة العناية المركزة (الطابق الأرضي)
        - وحدة العناية القلبية (الطابق الثالث)
        - مختبر القسطرة (الطابق الثامن)
        - غرفة العمليات (الطابق الأول)
        - قسم الجراحة (الطابق الأول)
        - المستودعات (الطابق الأرضي)
    - مستشفى التعليم التخصصي الجراحي
        - وحدة العناية المركزة (الطابق الخامس عشر)
    - مستشفى الرعاية بالأطفال
        - قسم الأرشيف.
        - وحدة العناية المركزة للأطفال (PICU).
        - قسم الأشعة CT و MRI.
        - عيادة السكري والغدد الصماء.
    - مستشفى العناية المركزة العراق وكوريا (ICHIK)
        - الموارد البشرية
        - المستودع
        - السجل الطبي الإلكتروني
        - نظام معلومات المختبرات
        - السجل الطبي الإلكتروني
        - نظام أرشفة وتواصل الصور (PACS)
    - مستشفى أمل التعليمي للأورام
        - نظام سجل السرطان

3. مديرية الرعاية الصحية بابل
    - مستشفى الإمام الصادق التعليمي
        - وحدة العناية الكلوية

4. مديرية الرعاية الصحية النجف
    - مستشفى الزهراء التعليمي
        - نظام سجل سرطان الثدي
    - مركز الصحة الطبية العدالة
        - نظام الطوابير والسجل الطبي الإلكتروني.
    - تسجيل اختبارات مختبر مرضى كورونا: أثناء الجائحة

القطاع الخاص:
1. محافظة النجف
    - مستشفى الأمل للحياة للأورام
        - نظام السجل الصحي
    - مستشفى الحياة
        - نظام السجل الصحي
2. محافظة بغداد
    - مستشفى الحياة للراهبات
        - نظام السجل الصحي
    - 250 صيدلية: نظام إدارة وشبكة على مستوى البلاد.
    - 150 عيادة: نظام إدارة وشبكة على مستوى البلاد.
    - 10 مختبرات: نظام إدارة وشبكة على مستوى البلاد.

في الموصل، ديالى، الحلة، الكوت، البصرة وغيرها من المحافظات.""")

pdf.add_chapter('تواصل معنا', """- الدكتور عبدالسميع م. علي
    - بكالوريوس في الطب والجراحة (M.B.Ch.B.)
    - دبلوم دراسات عليا في السكري (المملكة المتحدة)
    - ماجستير في الغدد الصماء السريرية (المملكة المتحدة)
    - المدير العام، شركة القلب النابض
    - الموقع: العراق، بغداد، زيونة (مقابل دريم سيتي مول)
    - الاتصال:
        - الهاتف: +964 780 555 1055
        - البريد الإلكتروني: co@nhs.iq""")

# Save the PDF
translated_file_path = 'Beating_Heart_Company_Profile_2024_Arabic.pdf'
pdf.output(translated_file_path)
